# Day 18

## Part 1

> Evaluate the expression on each line of the input.
> What is the sum of the resulting values?
>
> The addition (`+`) and multiplication (`*`) operators
> have the same precedence,
> and are evaluated left-to-right
> regardless of the order in which they appear.

```js
const input = `
2 * 3 + (4 * 5)
5 + (8 * 3 + 9 + 3 * 4 * 3)
5 * 9 * (7 * 3 * 3 + 9 * 3 + (8 + 6 * 4))
((2 + 4 * 9) * (6 + 9 * 8 + 6) + 6) + 2 + 4 * 2
`.trim()

const sum = input
  .split('\n')
  .map((expression) => evaluate(expression))
  .reduce((a, b) => a + b)
console.log(sum)

function evaluate(expression) {
  let nextExpression

  if (expression.includes('(')) {
    nextExpression = expression.replace(
      /\(([^()]+)\)/g,
      (match, subExpression) => evaluate(subExpression)
    )
  } else {
    nextExpression = expression.replace(
      /(\d+) ([+*]) (\d+)/,
      (match, a, operator, b) => (operator === '+' ? +a + +b : a * b)
    )
  }

  return isNumber(nextExpression) ? +nextExpression : evaluate(nextExpression)
}

function isNumber(expression) {
  return /^\d+$/.test(expression)
}
```

[_Try it out on flems.io_](https://flems.io/#0=N4IgtglgJlA2CmIBcBGADGgNCAzvBAxgC7xTK4D2sArkRBQHYB0AVjiNgGYQLtIDaoBgEMwiJCAgMADrVbtsBRiQZFyShjiIACKbJ0BebQAMAOgwAUFgKzaA1NoAc97QGYAlC48uLrlwE5tACptAHZ3cytbB28QwJCLeO0ANhdUkIAWTwcbF2t3TxDnOMjQn3S3NODtDOrAmMKaqodHbO0o5u1bEL8exosK4qdq6JqC6rKHJOTzXpTquecc2pDUluqLIZX5hyyfbb9dlyXhuMbWr3MK2pyk+q627qap80nn99GLACYfJLmvxrJNr+cw-I45H5nLx1ALme5WNbaSGVEIAlxvMoJTHaJJPfxtWIpOETFzbJ5WbFAhak-rbMFhar0izYoZJC4OAGzY4+b4TRpPJlPN5sxkFSJDKmZUl5GEJUY3d7TCIMIaJcok1EjNrhS4MZFPRzmUb0irkuYKt7I5EeV7VE4VGaWbGHYY5S3VOkuZH4jbbYV2xo6orqjnUhzXNoDAJtIauSL69E+J5+6pU252gKylLjdY5E75DPh45XX7QkIFhzWcUbOZzUaDNoNvKg7kxGt5frk+57Iuo5UuqxJHuupqZfpR4PltKNJn0tG99oncIz1OwywnNltMmruWJkKUmXh5WbPeVNuhyvayL3ZG+D2pxreSv7F-gpza84be5vE7zsLxr1fWnUURm5KUWnMbYrBdOcZ3HE5WRJNs+1LC83BzBlg0rW0ck+PF7ylfdI2RH9ASQsZGVAzJSlQ7NoQcN4owY6U33xMjsMsIdAPLdj2lyc8cRlTVVgJHwSMo-dyKDTCHg9Fseg2T4b3vFpgT5DZri-VskQDTMEm7Kox2jCZIm2E41V2NpxMvVN5NORdDxHZkNR0oyjJyCwFSfGT7htBhEVVOZnLiQCj1XVSsy+EssJ2dof241z30iYL0IfFTRxk7ZHVNDZGKVNKIIYJ4B22XENPCnTmIUo9lSSO9kPsxEmSSAFHzDLpTI2cTJxxD8CK6UlzFVT4FUldplJi5EsmVPKYWYjk1N2Yk3UMkdjTEsD5lWadlURBUtjLca9JRDL8WJbasR8X9IoDZUoMQhIcss9FIzq0ZnXI7sxQYAdPhdUbVvZXqMwUkoivKkK0JTIifDrLS0PwsKEnpeVGjpSMLMEoorJpQ6q3B-TKOfBrPMclkMICxzDXXITYtNRb2npVUytBsJvoOTN5vaF0gv2iT32PKCniegaIqq9oAc1JG2Z5AyuZdNMMt5ItQynBcxqGetH1tBI1RE2HDuumG81PaaFiGnkUfS4dNJW4mtplgS7xCi6sbZldli9HHCqtK6k1xlaoQSDn1ldoHSefSSjhQ9NI8EqYQbGQM7InJX3upPptMV7ErHpbEFWHZyVfj2K9hig4cbBqbpVZ-Plr4t4FeMtD6rPAaRLuuSfrm-8GDeM0WIol2Or1WiK3bkc40sZNCzohPWf4kcknCZKcuHsuMqBpcu6sUb+VAhG0uEzfiyddtLxjFs0IOz3nvLADg5rmSHqRbUd1fomcWvRMpkbRSf5HNJOquRtoNThvrUB6EuSSR6uZTSbkkTnROqnTGox8zjB6Mle4sY6iNBFGLNwFtCYxQqLyNWlUS5mwaicKe0EAEVDeDbP2PF2rk35kxRmtNq4IOxPSIKox1pThgQLJB9YtJSw-g1fGcxERNRGFyBO9tSYJEWHyPBPJES8PaujCq71jyqm3AJOYy5aY4IXqRTq883ZjRSh9KOdFHrNyJATB2CJ357RAoo9oiJsGiRQkI7m2k-IOgNtHd8XVB4cOxKRZUzN36MQdMCP+Hk9r9AqDIhKm5jgY2usXOcWoPSxO0p8PWbsDRvwSOg8qDQ0YRNwrgzutd+qfAqGdSwTJ0kAP+rSLw+97FAyFNpZRI5WjVlzBPT02MXwiSQSeMJcx7j0z9nHBUoxFm1PFvjVuQVvRZ35LU4R9ocLeNPBHd4msVzgXCdRBg24rkYjsoiVOjE+ZxxnnfByNlLJGgSovEBz9Az-wQc7E6bEKoggYPCF0qp3SsxgmjTsAdEGWCytUtu3lhkmiprdUKPlcWhG-g1Dx0sMiRAWaeJ5iJCRokgasilRC4qzzISOJmr0M5t1aFZQlpcNhDH7u1J449CRBRgu2HquIML0lxEg8yIKUbqLjjSk6Wz4Sa2yYinqxV4YnUbtGNqHkQ5u2hYCNGyUFTWkHllCpyrHjvyiqPZG-NPjIntP1f4+reoWy5nw0s5DOSWH+rlQePoIqOKhAa9lvsAk+kgXM3qldnEMNCe0YW-MpUYJGQy1OAoNqaqPic4Ry8D6v2SRlKejFtnvwuNVDln4IRUQymva5iV8ZvCeQqENE9bz-KVRic+lCnFDmVAIoCcd8yfUvii-mY17hbI7fRBxiVHSLxscrd4-K4VblxfOiBjLxbDK8qtaS-d+iLJcoiZMx4QUxvskqxeqb7adtIao8hjD+g+shm7K1XqnIHkfkY72UCVT9Rzn8TaVSGJXwbgAgu+8vkyX+Te0lfdk2jMhcW1Vr5zl9JLmuvejTGUL2wZ0RWowBz3BZuhQE0UJ6YfqcPceciFpBuxsld5MklXyg2qHd2-b8iRDIw2k8UzxUM2Aea3Sxte5cXTDWjmrH-L+3tgmTONalwKPXUBFhHIf0bsIS4tdOoPJ-A9idYcJxkOaNxUyOJUNMnfT5byrDBoaSCwhjJbEs71LDyiZ+GOKatQP1imIkTE8R01qLi25Ut5GGHQvU4lzhMGL9i0ycxVFU97ufWeRSLFq3z7UfFe78nQ4ZhWS8Gu0Yzm0+PZa3V52YSw5AHC6cmtVdE8k8y5IBpiEreS2U85ESbw1t1KYSYZ-Li54gwg87uTsgp-oomhQYhT0RQdbq6+xG8XVQZ3Tyz29i2kpVkTl7EaDziXORSaSCPJ06q3CfRieuq+htVRPXEF0T-7lbfJFoEM47IlPHRInRwi-JxsJAwjTG40Vgd3O5PdLKYwzU6HQu7XHQ2yXvu02eqKVGHXyQEpV1aT72PtVBZltYF1AMeEgpuMRGu4ehcW8yPMBWJ2mhpvtYaS7539iTwpok6dY8qQuxWSrkNFuFxI28u3oZJyft6HWTl-i4t8SGeyQtHLZxSzkJjJcL1tcdbuvlNFtOfOQfSC0g8xptsjFonXq1vLeQhyhrmi8tjHmshlaSpSOmcwnizhoTn-M3uXpEEW34GZ8Kg7eO47VIsb0xrHgSnHbWXXt-B3t12CfsvMjQ9+MmGvgw8uaXSZWR50pJjg8W0wVv7hN8Fz+LoCwSJfij0WDJxlDD-GBu7FQ72lTqW3G9eiNODeOqQ324sV6WCpbTEJMNHGd-ZdPyLwrR24firS9lhJpJMnJX2aBHe3Y96cFn9vxXXZnPnajz7DsK5FN1taSMhrx5rsE96nas9qYKgpAA5vS7IxacjUMYLdel19EkHxFcf905F8P4t9M4OJzJtgK9EpE84sMJAohkvMwktFd1Zorkb0-Ihgu9i0yd2M-xltP0shD8T8BQ7JRVdYI9rNmFFQq0XpTxO1Q9FMwlW5Sk+9wU+oBJpF+ozlq4uZpIEJuN3hvQCMUpwEj9SkTFDd29mU1kDlXEXRsDsxxwsV7Yid-lND3E8EBdT9p5tINsMoN4+9jlhMHY-wQViUfJotcU3EplvkzCx0c9U9pC6hkoX5hYyJj4R1npCoa8JF-l3RxYE9OlLw1tQN2UhRvpWkNhMZ9DyVf4Ss343lkpjVTxyN2VVkM1aETRn935-8aFD8XlTxj0hMNcYpd8H8HYJpTCS844UoJMFoz8rZlCpsflBdSFW4mx60a0PppYMlLpIETEGpphrsvE6p+C-U0VYVtCsM-x7U21xFMoG0SjDpkNbCBw+8MI289Mz0CEi10cIUK0LRAUepWjCMHhzg+ijUXCFs5YAtq9zsGUgCQVW5GNajVok14NqV+00MUw7tGJGIS9IFEjxxbZ7JO13ssxZF1Dhk2Iw9ikcs7kS59QjjOkZki94cxof9FDgIHtEYPNelZDVd7Y0EvRLEjpPCa071593gttqN0NCIRtaSwkGE-5ccItXUFo3NccFwm9cUicgZPRA4GSv0G0FkM1qZStOEmtNpBVE5CQ1T7YJCf0DiKonkb424LdbVmNxkp4AZ90RYf98EZJ-9X9aw0k8i48pVilvp9inMeN0061e4SCksKFkDPFGpT5bxNCHSbIDsf15NlSZS-xJCVSa18gt1YDA0rFp9JDdYzJyIgZld91Y8xwtx0Sa0vNP0zl5D7TJ1bDDjyIoJfIG1jtVMag1sKNT1HJGcTSAtfSrM7tCd1QzhGjszkUlTUie5mVdk2zV8tQUtdxWILsmoU5HM08TpHCdjk9TVu4fM9MBw30QJ+lmwUNJcZIgojZFz+hxj3hjVdoyZUt4oFx70M1xdVowSzcnlTsFSf1IsNjWZ5iF0wU68z5xCJ1tJZ1o8n5-kIjbcMsWywDDlrUp5NSFCvp+YCUHV7IrANwNkRwNc0IGC25FYxpbw6yS5x58YLCOExE0JM9FMRTAFcEU4tC991J4NXCRlaZC5YswkC4vZwNAsp0SEAFSkET-S+x+hcCZJKZTcc58KKoocpMV0swYdZJxZ9DYJOoYoc1A9vsI8sF81clAlXYjM4CN9P53d88u5zToMeT1CiyFKS5zQaNMZeZtyJZsdsloxjk+0eNhYuidS1dzIJcdVAUp9VzgFPdSoE01SFz3UkUzlgj4Lp19k6TkLU5YxhKKVVpGNjkSkIwctRVxk1L415ECS89L8DCvThl+C7sN5x5kNUU4y3YOExKfCxySJ+hEI3wEyTJOIxVJ4Ox35ds-iwZMZYIF1bCXMuZzN35nkStRQ3tcsXJl4-Eh5TDUFb9Ldi4wUtS1t7QUryE0zcM0Lh1B8Z4JFUlzYA1VpfJTN8kdMhcbTfVYpJSMYT8JRgJ9YsLZjAkvE1kuqEKxwGU-R6Sic9jSlzUt0bzPMWr2VeSVt9s-T2D08zcH1gY8kvYVLMobiOVdQMkPI1UiVcFDZOhUYEiUjupF170sxlxUa1D+pWrEpijybeqkUWdh57VgEiqTofTFqB9H5OSKM8aQi0sjpj5eE+TYqiIRakL8JhEkK8taalNOEF8gNYzzKfDIE7gNV7IsaMdYpDyHxTMIU116rB5yielqEEjTNmUFsgQ7LD07Zb0EolCR440f8VM79S8EM6w2VTSMI8rdUPJSI+LeSilINR5xkoJA17F5sAEmCPk9jJlJEnLhERzx8FVHZYoKy0q-dZrksDqp8IkJicKXLhtVRx0KqAwaJe8Eo1ji0LUbk3EoZIwPEeoP1U6vI1IYpmiVVzrIl4V2SYrbCc4abN8HYtc0gyUKpmqKpmVYNNpbDUSE0po2sUkXJD1WZFZcytaRUqyClH16cdK-lWQtwCQgtGcAk10m1KYal3EuF693zHSBIgZBscN7VEt4dtSzDTcBi2Kj9zQUqUz2Dd1yQTr4bUzMz19F4azA8zhD9ddr1Np4FrLSociF0oSMKkl3N1pXddrvIH67qz780qaYozkfcF1yjOg0MYtB98phdxlOzFtBadVesIa2qijvzTrfd+STp7SerXYYIqtSFL0FgvS20Oc5bxt+c7rAHAZ0b9LHQSD7YJNdY7ctavywlfxIxBkAklHx5-Ujsuruk8bMEOSl4+Kq8ONtr3iDK38VcoKUK8qd8CN4QBsAFnR1G1EErmi85yJiLyJdkbkB9ZMJkXIFYg7OHNjlqap6dSLOh9LZLqGJ4WTWoKokKnlYGrFSNdEPcCbZ4kMfADw0IbwuVblNiPseMZHNoSI3zYt9zO04kJEb0icKnKLcM6oz1j4RY70XUFTec25nabpk8DH5aKEWRC7PVOq4nm6tY8iHSdzbaN54VJ6X1QmpNpaXCWti0c5r8NaCRiIJqL6B0Fa6pnTP0myRnBhy6C0G9h5hRrUabSkYDeMeNZGs5NpNzb8m5XYQ9cmAFdr0kPxD9d4EotqcsJ7Y4vdDZTNhwJtnFRztabtnK0J9KedQsIVWmBbyQLNS0xGpaM1-RBdeno0Lz7dwio0KEaFHgsioygplJ5HcVsH2FTiqN6dZxnHCnKVonEUeNmVjsUy4N11k4inyFisl6ECTosVWY0iZ6PtmbJMzdPHxkETJbLmh9vo8JuGR4c5nyglBG-dEis4qsQUyL29Fg7zFdOtlCRKidHRyQV02VCyM1DX207qlT0nOSQHY0k8KFNb+7ymfGMJ9bli10ESUHEXSSML3M-woIT0fkrni0OE0NETq9ll7tk3-kX7ONb8yoW5L11F9ySaV9LdP1X8OFWyZZXZHD-9Hyr8eyW1KSoMuJE6DFtIE9btFrQcA92a-M+IQzjoZab03dbX46IU6VFH2pWljDunCDo2VCNGLHO1qC9yBaNiwyVD4QxD3gmpeWtV8TSFzj29hxNnspUNaYoUCbvpfaoz+N36LG19mNua55oWNFz1f6j8Wp312o1aXsBb5DVCusjbQbUpxYp4rMOGMUTnXsQ6UL6tU4T7Za8y87cMdiYphUU4uNY0XVob737VMYNZnnCpzJJ97jZ880FaMULN+o2kd2j1OLj4OF+3B4Fs7nqiM19Q3tRioylasyKXVQyqnVtWAlHWBJM2qMCrnrlDsLvWaTrNS1cK01FcUoWpsri1fs1xKPOTKP1YCpgYihjlN67s+D4laYhV2E-QcXjpaFTt1nHLNXHU44YOyREyl4CNNn-S8PE5Db26KXGEqtkyj9pJiodtaJ4taqQaeqEXT5oOCliy8SkpLAf2eSEprdIumjGRFcgpU30pRrFqC9ITVox9+bvJhRFdSFkiM8A7elV58UyY26tOE6oyhtS3rL1707OjuCwXiF4nP5FYtgz9yTULKdANx5qYkX4dVQoaY38TQDBdIsu9ANmVsswlyQF7qxQsrZg7GIfm3a83TrqyMNP2kKhW9c7qGXDt5Lrc1smQ46bc5q5LeJmsuKFb7UyPww5OSWwcRnBj1SU7E8M1fiaLYuvqFbW4JVl7+oZ0e4vrrrZL6kMixrtW9PiMAkD6Z68qxop44Eurrz7IKaGBjAmAiAAAnCAMACwZUDgXAfAeAYgegTQcgVwRwFAJANAEAAAX0wCEFEHEEoBoDoEYHkDJ40BUDUAkA0C0G0BwGoDAG0CMD0FoHMG0G0CYBwGkFgAgCIAsAAHJTBzB1flR5emAwBhBpArB4AAAPaQfH+AHAHAanzwAwAAPm0HgAADdhAaBhASALBTfzfLfrfGBvo9eLeoBqACB4ArBhBMBtAAAjW3h34QFwaP8wEXqgeAJgWACgAAcwsHF7AGVHME4GoAYCp8YEd5d7d49694t6t5t+0GADl+0AQB0AYFN6IAAFEzfK-feGBzA6+IBOB2gK+ffqemApACAaAoBLeNeNfxha+GB5f5em+TfW-2-B-i+jAB+q-eeLflfhAQ+LA6+5-tAAB6LXqwfgAAPRJ4AF07AIhTB3BD-0-MB9+5+LADeiACAAALCP8XyPtv73jfhgDHxL6u9qA7vUPj-z-4d8bez-XXtoGZ6O9YAeAGvs-wX5L9-+nfKXo72X4ACmAW-WADv1D7P95eh-PfqYCgA392g-AOwEEEv6eBSB5A+-k-1n4H92gb-T-hH3D7aAKA0geAPj3d4UB8eEfaPlLwd4WBuBvA-gfjyl4GAjA6vOwOr20AAB+ewHHwcB2BI+2gJANoDj4hAE+zA+XrAOZ7d9mBFvIgNQHx6z8IAOAAAHIS9I+vAiwKgMgEr9ABSg+wE4OwEYCtBzvEAWAMcHN9nBAA5UEYK74MB8+hfHnpYJsF2CHB6-Tvp4Bn7y9TB5g2fofzP5a9yBAAEkP549LeavOIdAIYAhD+eFAMANIB4C8DkADAagLAFgDYA8AhASIXwBAAZBUAyQFnpf2Z5AA)

I like this solution!
The regex for sub-expressions (i.e. expressions in parentheses)
is a bit noisy,
but other than that,
I like how clear and simple this is.
It's also faster than I anticipated:
with the real puzzle input,
running the code takes about 7 milliseconds on my machine.

## Part 2

> Same as Part 1,
> but now addition is evaluated before multiplication.
> What's the result now?

The solution is almost identical as in Part 1.
Instead of evaluating an addition or multiplication operation,
we need to evaluate addition operations
if the expression contains an addition operator (`+`).
Otherwise we can evaluate multiplication operations.
Like so:

```diff
+const operator = expression.includes('+') ? '+' : '*'
 nextExpression = expression.replace(
-  /(\d+) ([+*]) (\d+)/,
-  (match, a, operator, b) => (operator === '+' ? +a + +b : a * b)
+  new RegExp(`(\\d+) \\${operator} (\\d+)`),
+  (match, a, b) => (operator === '+' ? +a + +b : a * b)
 )
```

[_flems_](https://flems.io/#0=N4IgtglgJlA2CmIBcBGADGgNCAzvBAxgC7xTK4D2sArkRBQHYB0AVjiNgGYQLtIDaoBgEMwiJCAgMADrVbtsBRiQZFyShjiIACKbJ0BebQAMAOgwAUFgKzaA1NoAc97QGYAlC48uLrlwE5tACptAHZ3cytbB28QwJCLeO0ANhdUkIAWTwcbF2t3TxDnOMjQn3S3NODtDOrAmMKaqodHbO0o5u1bEL8exosK4qdq6JqC6rKHJOTzXpTquecc2pDUluqLIZX5hyyfbb9dlyXhuMbWr3MK2pyk+q627qap80nn99GLACYfJLmvxrJNr+cw-I45H5nLx1ALme5WNbaSGVEIAlxvMoJTHaJJPfxtWIpOETFzbJ5WbFAhak-rbMFhar0izYoZJC4OAGzY4+b4TRpPJlPN5sxkFSJDKmZUl5GEJUY3d7TCIMIaJcok1EjNrhS4MZFPRzmUb0irkuYKt7I5EeV7VE4VGaWbGHYY5S3VOkuZH4jbbYV2xo6orqjnUhzXNoDAJtIauSL69E+J5+6pU252gKylLjdY5E75DPh45XX7QkIFhzWcUbOZzUaDNoNvKg7kxGt5frk+57Iuo5UuqxJHuupqZfpR4PltKNJn0tG99oncIz1OwywnNltMmruWJkKUmXh5WbPeVNuhyvayL3ZG+D2pxreSv7F-gpza84be5vE7zsLxr1fWnUURm5KUWnMbYrBdOcZ3HE5WRJNs+1LC83BzBlg0rW0ck+PF7ylfdI2RH9ASQsZGVAzJSlQ7NoQcN4owY6U33xMjsMsIdAPLdj2lyc8cRlTVVgJHwSMo-dyKDTCHg9Fseg2T4b3vFpgT5DZri-VskQDTMEm7Kox2jCZIm2E41V2NpxMvVN5NORdDxHZkNR0oyjJyCwFSfGT7htBhEVVOZnLiQCj1XVSsy+EssJ2dof241z30iYL0IfFTRxk7ZHVNDZGKVNKIIYJ4B22XENPCnTmIUo9lSSO9kPsxEmSSAFHzDLpTI2cTJxxD8CK6UlzFVT4FUldplJi5EsmVPKYWYjk1N2Yk3UMkdjTEsD5lWadlURBUtjLca9JRDL8WJbasR8X9IoDZUoMQhIcss9FIzq0ZnXI7sxQYAdPhdUbVvZXqMwUkoivKkK0JTIifDrLS0PwsKEnpeVGjpSMLMEoorJpQ6q3B-TKOfBrPMclkMICxzDXXITYtNRb2npVUytBsJvoOTN5vaF0gv2iT32PKCniegaIqq9oAc1JG2Z5AyuZdNMMt5ItQynBcxqGetH1tBI1RE2HDuumG81PaaFiGnkUfS4dNJW4mtplgS7xCi6sbZldli9HHCqtK6k1xlaoQSDn1ldoHSefSSjhQ9NI8EqYQbGQM7InJX3upPptMV7ErHpbEFWHZyVfj2K9hig4cbBqbpVZ-Plr4t4FeMtD6rPAaRLuuSfrm-8GDeM0WIol2Or1WiK3bkc40sZNCzohPWf4kcknCZKcuHsuMqBpcu6sUb+VAhG0uEzfiyddtLxjFs0IOz3nvLADg5rmSHqRbUd1fomcWvRMpkbRSf5HNJOquRtoNThvrUB6EuSSR6uZTSbkkTnROqnTGox8zjB6Mle4sY6iNBFGLNwFtCYxQqLyNWlUS5mwaicKe0EAEVDeDbP2PF2rk35kxRmtNq4IOxPSIKox1pThgQLJB9YtJSw-g1fGcxERNRGFyBO9tSYJEWHyPBPJES8PaujCq71jyqm3AJOYy5aY4IXqRTq883ZjRSh9KOdFHrNyJATB2CJ357RAoo9oiJsGiRQkI7m2k-IOgNtHd8XVB4cOxKRZUzN36MQdMCP+Hk9r9AqDIhKm5jgY2usXOcWoPSxO0p8PWbsDRvwSOg8qDQ0YRNwrgzutd+qfAqGdSwTJ0kAP+rSLw+97FAyFNpZRI5WjVlzBPT02MXwiSQSeMJcx7j0z9nHBUoxFm1PFvjVuQVvRZ35LU4R9ocLeNPBHd4msVzgXCdRBg24rkYjsoiVOjE+ZxxnnfByNlLJGgSovEBz9Az-wQc7E6bEKoggYPCF0qp3SsxgmjTsAdEGWCytUtu3lhkmiprdUKPlcWhG-g1Dx0sMiRAWaeJ5iJCRokgasilRC4qzzISOJmr0M5t1aFZQlpcNhDH7u1J449CRBRgu2HquIML0lxEg8yIKUbqLjjSk6Wz4Sa2yYinqxV4YnUbtGNqHkQ5u2hYCNGyUFTWkHllCpyrHjvyiqPZG-NPjIntP1f4+reoWy5nw0s5DOSWH+rlQePoIqOKhAa9lvsAk+kgXM3qldnEMNCe0YW-MpUYJGQy1OAoNqaqPic4Ry8D6v2SRlKejFtnvwuNVDln4IRUQymva5iV8ZvCeQqENE9bz-KVRic+lCnFDmVAIoCcd8yfUvii-mY17hbI7fRBxiVHSLxscrd4-K4VblxfOiBjLxbDK8qtaS-d+iLJcoiZMx4QUxvskqxeqb7adtIao8hjD+g+shm7K1XqnIHkfkY72UCVT9Rzn8TaVSGJXwbgAgu+8vkyX+Te0lfdk2jMhcW1Vr5zl9JLmuvejTGUL2wZ0RWowBz3BZuhQE0UJ6YfqcPceciFpBuxsld5MklXyg2qHd2-b8iRDIw2k8UzxUM2Aea3Sxte5cXTDWjmrH-L+3tgmTONalwKPXUBFhHIf0bsIS4tdOoPJ-A9idYcJxkOaNxUyOJUNMnfT5byrDBoaSCwhjJbEs71LDyiZ+GOKatQP1imIkTE8R01qLi25Ut5GGHQvU4lzhMGL9i0ycxVFU97ufWeRSLFq3z7UfFe78nQ4ZhWS8Gu0Yzm0+PZa3V52YSw5AHC6cmtVdE8k8y5IBpiEreS2U85ESbw1t1KYSYZ-Li54gwg87uTsgp-oomhQYhT0RQdbq6+xG8XVQZ3Tyz29i2kpVkTl7EaDziXORSaSCPJ06q3CfRieuq+htVRPXEF0T-7lbfJFoEM47IlPHRInRwi-JxsJAwjTG40Vgd3O5PdLKYwzU6HQu7XHQ2yXvu02eqKVGHXyQEpV1aT72PtVBZltYF1AMeEgpuMRGu4ehcW8yPMBWJ2mhpvtYaS7539iTwpok6dY8qQuxWSrkNFuFxI28u3oZJyft6HWTl-i4t8SGeyQtHLZxSzkJjJcL1tcdbuvlNFtOfOQfSC0g8xptsjFonXq1vLeQhyhrmi8tjHmshlaSpSOmcwnizhoTn-M3uXpEEW34GZ8Kg7eO47VIsb0xrHgSnHbWXXt-B3t12CfsvMjQ9+MmGvgw8uaXSZWR50pJjg8W0wVv7hN8Fz+LoCwSJfij0WDJxlDD-GBu7FQ72lTqW3G9eiNODeOqQ324sV6WCpbTEJMNHGd-ZdPyLwrR24firS9lhJpJMnJX2aBHe3Y96cFn9vxXXZnPnajz7DsK5FN1taSMhrx5rsE96nas9qYKgpAA5vS7IxacjUMYLdel19EkHxFcf905F8P4t9M4OJzJtgK9EpE84sMJAohkvMwktFd1Zorkb0-Ihgu9i0yd2M-xltP0shD8T8BQ7JRVdYI9rNmFFQq0XpTxO1Q9FMwlW5Sk+9wU+oBJpF+ozlq4uZpIEJuN3hvQCMUpwEj9SkTFDd29mU1kDlXEXRsDsxxwsV7Yid-lND3E8EBdT9p5tINsMoN4+9jlhMHY-wQViUfJotcU3EplvkzCx0c9U9pC6hkoX5hYyJj4R1npCoa8JF-l3RxYE9OlLw1tQN2UhRvpWkNhMZ9DyVf4Ss343lkpjVTxyN2VVkM1aETRn935-8aFD8XlTxj0hMNcYpd8H8HYJpTCS844UoJMFoz8rZlCpsflBdSFW4mx60a0PppYMlLpIETEGpphrsvE6p+C-U0VYVtCsM-x7U21xFMoG0SjDpkNbCBw+8MI289Mz0CEi10cIUK0LRAUepWjCMHhzg+ijUXCFs5YAtq9zsGUgCQVW5GNajVok14NqV+00MUw7tGJGIS9IFEjxxbZ7JO13ssxZF1Dhk2Iw9ikcs7kS59QjjOkZki94cxof9FDgIHtEYPNelZDVd7Y0EvRLEjpPCa071593gttqN0NCIRtaSwkGE-5ccItXUFo3NccFwm9cUicgZPRA4GSv0G0FkM1qZStOEmtNpBVE5CQ1T7YJCf0DiKonkb424LdbVmNxkp4AZ90RYf98EZJ-9X9aw0k8i48pVilvp9inMeN0061e4SCksKFkDPFGpT5bxNCHSbIDsf15NlSZS-xJCVSa18gt1YDA0rFp9JDdYzJyIgZld91Y8xwtx0Sa0vNP0zl5D7TJ1bDDjyIoJfIG1jtVMag1sKNT1HJGcTSAtfSrM7tCd1QzhGjszkUlTUie5mVdk2zV8tQUtdxWILsmoU5HM08TpHCdjk9TVu4fM9MBw30QJ+lmwUNJcZIgojZFz+hxj3hjVdoyZUt4oFx70M1xdVowSzcnlTsFSf1IsNjWZ5iF0wU68z5xCJ1tJZ1o8n5-kIjbcMsWywDDlrUp5NSFCvp+YCUHV7IrANwNkRwNc0IGC25FYxpbw6yS5x58YLCOExE0JM9FMRTAFcEU4tC991J4NXCRlaZC5YswkC4vZwNAsp0SEAFSkET-S+x+hcCZJKZTcc58KKoocpMV0swYdZJxZ9DYJOoYoc1A9vsI8sF81clAlXYjM4CN9P53d88u5zToMeT1CiyFKS5zQaNMZeZtyJZsdsloxjk+0eNhYuidS1dzIJcdVAUp9VzgFPdSoE01SFz3UkUzlgj4Lp19k6TkLU5YxhKKVVpGNjkSkIwctRVxk1L415ECS89L8DCvThl+C7sN5x5kNUU4y3YOExKfCxySJ+hEI3wEyTJOIxVJ4Ox35ds-iwZMZYIF1bCXMuZzN35nkStRQ3tcsXJl4-Eh5TDUFb9Ldi4wUtS1t7QUryE0zcM0Lh1B8Z4JFUlzYA1VpfJTN8kdMhcbTfVYpJSMYT8JRgJ9YsLZjAkvE1kuqEKxwGU-R6Sic9jSlzUt0bzPMWr2VeSVt9s-T2D08zcH1gY8kvYVLMobiOVdQMkPI1UiVcFDZOhUYEiUjupF170sxlxUa1D+pWrEpijybeqkUWdh57VgEiqTofTFqB9H5OSKM8aQi0sjpj5eE+TYqiIRakL8JhEkK8taalNOEF8gNYzzKfDIE7gNV7IsaMdYpDyHxTMIU116rB5yielqEEjTNmUFsgQ7LD07Zb0EolCR440f8VM79S8EM6w2VTSMI8rdUPJSI+LeSilINR5xkoJA17F5sAEmCPk9jJlJEnLhERzx8FVHZYoKy0q-dZrksDqp8IkJicKXLhtVRx0KqAwaJe8Eo1ji0LUbk3EoZIwPEeoP1U6vI1IYpmiVVzrIl4V2SYrbCc4abN8HYtc0gyUKpmqKpmVYNNpbDUSE0po2sUkXJD1WZFZcytaRUqyClH16cdK-lWQtwCQgtGcAk10m1KYal3EuF693zHSBIgZBscN7VEt4dtSzDTcBi2Kj9zQUqUz2Dd1yQTr4bUzMz19F4azA8zhD9ddr1Np4FrLSociF0oSMKkl3N1pXddrvIH67qz780qaYozkfcF1yjOg0MYtB98phdxlOzFtBadVesIa2qijvzTrfd+STp7SerXYYIqtSFL0FgvS20Oc5bxt+c7rAHAZ0b9LHQSD7YJNdY7ctavywlfxIxBkAklHx5-Ujsuruk8bMEOSl4+Kq8ONtr3iDK38VcoKUK8qd8CN4QBsAFnR1G1EErmi85yJiLyJdkbkB9ZMJkXIFYg7OHNjlqap6dSLOh9LZLqGJ4WTWoKokKnlYGrFSNdEPcCbZ4kMfADw0IbwuVblNiPseMZHNoSI3zYt9zO04kJEb0icKnKLcM6oz1j4RY70XUFTec25nabpk8DH5aKEWRC7PVOq4nm6tY8iHSdzbaN54VJ6X1QmpNpaXCWti0c5r8NaCRiIJqL6B0Fa6pnTP0myRnBhy6C0G9h5hRrUabSkYDeMeNZGs5NpNzb8m5XYQ9cmAFdr0kPxD9d4EotqcsJ7Y4vdDZTNhwJtnFRztabtnK0J9KedQsIVWmBbyQLNS0xGpaM1-RBdeno0Lz7dwio0KEaFHgsioygplJ5HcVsH2FTiqN6dZxnHCnKVonEUeNmVjsUy4N11k4inyFisl6ECTosVWY0iZ6PtmbJMzdPHxkETJbLmh9vo8JuGR4c5nyglBG-dEis4qsQUyL29Fg7zFdOtlCRKidHRyQV02VCyM1DX207qlT0nOSQHY0k8KFNb+7ymfGMJ9bli10ESUHEXSSML3M-woIT0fkrni0OE0NETq9ll7tk3-kX7ONb8yoW5L11F9ySaV9LdP1X8OFWyZZXZHD-9Hyr8eyW1KSoMuJE6DFtIE9btFrQcA92a-M+IQzjoZab03dbX46IU6VFH2pWljDunCDo2VCNGLHO1qC9yBaNiwyVD4QxD3gmpeWtV8TSFzj29hxNnspUNaYoUCbvpfaoz+N36LG19mNua55oWNFz1f6j8Wp312o1aXsBb5DVCusjbQbUpxYp4rMOGMUTnXsQ6UL6tU4T7Za8y87cMdiYphUU4uNY0XVob737VMYNZnnCpzJJ97jZ880FaMULN+o2kd2j1OLj4OF+3B4Fs7nqiM19Q3tRioylasyKXVQyqnVtWAlHWBJM2qMCrnrlDsLvWaTrNS1cK01FcUoWpsri1fs1xKPOTKP1YCpgYihjlN67s+D4laYhV2E-QcXjpaFTt1nHLNXHU44YOyREyl4CNNn-S8PE5Db26KXGEqtkyj9pJiodtaJ4taqQaeqEXT5oOCliy8SkpLAf2eSEprdIumjGRFcgpU30pRrFqC9ITVox9+bvJhRFdSFkiM8A7elV58UyY26tOE6oyhtS3rL1707OjuCwXiF4nP5FYtgz9yTULKdANx5qYkX4dVQoaY38TQDBdIsu9ANmVsswlyQF7qxQsrZg7GIfm3a83TrqyMNP2kKhW9c7qGXDt5Lrc1smQ46bc5q5LeJmsuKFb7UyPww5OSWwcRnBj1SU7E8M1fiaLYuvqFbW4JVl7+oZ0e4vrrrZL6kMixrtW9PiMAkD6Z68qxop44Eurrz7IKaGBjAmAiAAAnCAMACwZUDgXAfAeAYgegTQcgVwRwFAJANAEAAAX0wCEFEHEEoBoDoEYHkDJ40BUDUAkA0C0G0BwGoDAG0CMD0FoHMG0G0CYBwGkFgAgCIAsAAHJTBzB1flR5emAwBhBpArB4AAAPaQfH+AHAHAanzwAwAAPm0HgAADdhAaBhASALBTfzfLfrfGBvo9eLeoBqACB4ArBhBMBtAAAjW3h34QFwaP8wEXqgeAJgWACgAAcwsHF7AGVHME4GoAYCp8YEd5d7d49694t6t5t+0GADl+0AQB0AYFN6IAAFEzfK-feGBzA6+IBOB2gK+ffqemApACAaAoBLeNeNfxha+GB5f5em+TfW-2-B-i+jAB+q-eeLflfhAQ+LA6+5-tAAB6LXqwfgAAPRJ4AF07AIhTB3BD-0-MB9+5+LADeiACAAALCP8XyPtv73jfhgDHxL6u9qA7vUPj-z-4d8bez-XXtoGZ6O9YAeAGvs-xF46AKA0geAPj3d4UB8eUvR3svwAHD9C+Y-CfurzsA69tAAAfm0BkD1e2gJADQKCCa9Z+c-Bfkv3-6d88B6-TvkwC36wAd+ofZ-vP3gAAB3bQAACV4A6fP-hYGMB78tepgKADf20AKDTAAAEmADoDMB2A-HvAPkFa8lB7gYwO4Cf4sCD+r-d3p-wj7h8o+QAiwFoKwFEAcBUvAwEYFoFUD7AcfBwHYEj70DtAcfEIAnzMHaBYBzPbviwIt5EBqA+PWfhABwAAA5CXpH0wEWA2BkAlfoAI8F2A0hBAzgQwOd4gCwBqQ5vukIAHKgwhXfBgPn0L489YhCQpISkO4HV8Z+8vSIdENn6H8z+BguwGoMP549LeavJoX73MAVD+eFAMANIB4CYDyAkfYQMkNgBk88AhAWoXwBAAZBUAyQFnpf2Z5AA)

This code is slightly slower than the code in Part 1,
but still very fast:
it now takes about 10 milliseconds to run on my machine.

## What did I learn?

My solution is based on
[`String.prototype.replace()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_function_as_a_parameter),
and especially on
[specifying a function as its second parameter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_function_as_a_parameter).

I did know that you can specify a replacer function for `replace()`.
For example,
the [fast and lightweight date library Light Date](https://github.com/xxczaki/light-date)
utilizes `replace()` with replacer functions.
I have used Light Date in
[my blog](https://github.com/mtsknn/mtsknn.fi)
and also done
[small contributions](https://github.com/xxczaki/light-date/commits?author=mtsknn)
to it. :slightly_smiling_face:

I however hadn't used `replace()` this way from scratch,
so now I learned to use it
(very easy &ndash;
but very nice!).
